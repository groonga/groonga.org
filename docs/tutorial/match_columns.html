
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>4.7. match_columns parameter &#8212; Groonga v13.0.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../_static/styles/bootstrap.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=796348d33e8b1d947c94" rel="stylesheet">
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94">
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-7532323-1"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'UA-7532323-1');
            </script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorial/match_columns';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://groonga.org/docs/_static/switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'english';
        </script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4.8. Prefix search with patricia trie" href="patricia_trie.html" />
    <link rel="prev" title="4.6. Tag search and reverse resolution of reference relationships" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
   


<a class="navbar-brand logo" href="https://groonga.org/">

  
  
  
  
  
  
  

  
    <img src="../_static/groonga.png" class="logo__image only-light" alt="Logo image">
    <img src="../_static/groonga.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  
  <div class="col-lg-9 navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
    </div>

    <div id="navbar-end">
      
        <div class="navbar-end-item navbar-persistent--container">
          
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
        </div>
      
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/groonga/groonga" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://twitter.com/groonga" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-square-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="/blog" title="Blog" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fas fa-blog"></i></span>
            <label class="sr-only">Blog</label></a>
        </li>
      </ul>
      </div>
      
      <div class="navbar-end-item">
        <div class="version-switcher__container dropdown">
    <button type="button" class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle" data-toggle="dropdown">
        english  <!-- this text may get changed later by javascript -->
        <span class="caret"></span>
    </button>
    <div class="version-switcher__menu dropdown-menu list-group-flush py-0">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
</div>
      </div>
      
    </div>
  </div>


  
  
    <div class="navbar-persistent--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
    </div>
  

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/groonga/groonga" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://twitter.com/groonga" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-square-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="/blog" title="Blog" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fas fa-blog"></i></span>
            <label class="sr-only">Blog</label></a>
        </li>
      </ul>
      </div>
      
      <div class="navbar-end-item">
        <div class="version-switcher__container dropdown">
    <button type="button" class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle" data-toggle="dropdown">
        english  <!-- this text may get changed later by javascript -->
        <span class="caret"></span>
    </button>
    <div class="version-switcher__menu dropdown-menu list-group-flush py-0">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
</div>
      </div>
      
    </div>
    
  </div>

  
  <div class="sidebar-start-items sidebar-primary__section">
    <div class="sidebar-start-items__item"><nav class="bd-links" id="bd-docs-nav" aria-label="Section navigation">
  <p class="bd-links__title" role="heading" aria-level="1">
    Section Navigation
  </p>
  <div class="bd-toc-item navbar-nav">
    <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">4.1. Basic operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="network.html">4.2. Remote access</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">4.3. Various data types</a></li>
<li class="toctree-l1"><a class="reference internal" href="search.html">4.4. Various search conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="drilldown.html">4.5. Drilldown</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">4.6. Tag search and reverse resolution of reference relationships</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">4.7. match_columns parameter</a></li>
<li class="toctree-l1"><a class="reference internal" href="patricia_trie.html">4.8. Prefix search with patricia trie</a></li>
<li class="toctree-l1"><a class="reference internal" href="lexicon.html">4.9. Additional information about lexicon for full text search</a></li>
<li class="toctree-l1"><a class="reference internal" href="micro_blog.html">4.10. Let’s create micro-blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="query_expansion.html">4.11. Query expansion</a></li>
</ul>

  </div>
</nav>
    </div>
  </div>
  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

  
  <div id="rtd-footer-container"></div>

      </div>
      <main id="main-content" class="bd-main">
        
        
        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                
            </div>
            
            
            <article class="bd-article" role="main">
              
  <section id="match-columns-parameter">
<h1><span class="section-number">4.7. </span>match_columns parameter<a class="headerlink" href="#match-columns-parameter" title="Permalink to this heading">#</a></h1>
<section id="full-text-search-against-multiple-columns">
<h2><span class="section-number">4.7.1. </span>Full-text search against multiple columns<a class="headerlink" href="#full-text-search-against-multiple-columns" title="Permalink to this heading">#</a></h2>
<p>Groonga supports full-text search against multiple columns. Let’s consider blog site. Usually, blog site has a table which contains title column and content column. How do you search the blog entry which contains specified keywords in title or content?</p>
<p>In such a case, there are two ways to create indexes. One way is creating column index against each column. The other way is creating one column index against multiple columns. Either way, Groonga supports similar full-text search syntax.</p>
<section id="creating-column-index-against-each-column">
<span id="id1"></span><h3><span class="section-number">4.7.1.1. </span>Creating column index against each column<a class="headerlink" href="#creating-column-index-against-each-column" title="Permalink to this heading">#</a></h3>
<p>Here is the example which create column index against each column.</p>
<p>First, create <code class="docutils literal notranslate"><span class="pre">Blog1</span></code> table, add <code class="docutils literal notranslate"><span class="pre">title</span></code> column which stores title string, <code class="docutils literal notranslate"><span class="pre">message</span></code> column which stores content of blog entry.</p>
<p>Then create <code class="docutils literal notranslate"><span class="pre">IndexBlog1</span></code> table for column indexes, add <code class="docutils literal notranslate"><span class="pre">index_title</span></code> column for <code class="docutils literal notranslate"><span class="pre">title</span></code> column, <code class="docutils literal notranslate"><span class="pre">index_message</span></code> column for <code class="docutils literal notranslate"><span class="pre">message</span></code> column.</p>
<p>Execution example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_create</span> <span class="o">--</span><span class="n">name</span> <span class="n">Blog1</span> <span class="o">--</span><span class="n">flags</span> <span class="n">TABLE_HASH_KEY</span> <span class="o">--</span><span class="n">key_type</span> <span class="n">ShortText</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">column_create</span> <span class="o">--</span><span class="n">table</span> <span class="n">Blog1</span> <span class="o">--</span><span class="n">name</span> <span class="n">title</span> <span class="o">--</span><span class="n">flags</span> <span class="n">COLUMN_SCALAR</span> <span class="o">--</span><span class="nb">type</span> <span class="n">ShortText</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">column_create</span> <span class="o">--</span><span class="n">table</span> <span class="n">Blog1</span> <span class="o">--</span><span class="n">name</span> <span class="n">message</span> <span class="o">--</span><span class="n">flags</span> <span class="n">COLUMN_SCALAR</span> <span class="o">--</span><span class="nb">type</span> <span class="n">ShortText</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">table_create</span> <span class="o">--</span><span class="n">name</span> <span class="n">IndexBlog1</span> <span class="o">--</span><span class="n">flags</span> <span class="n">TABLE_PAT_KEY</span> <span class="o">--</span><span class="n">key_type</span> <span class="n">ShortText</span> <span class="o">--</span><span class="n">default_tokenizer</span> <span class="n">TokenBigram</span> <span class="o">--</span><span class="n">normalizer</span> <span class="n">NormalizerAuto</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">column_create</span> <span class="o">--</span><span class="n">table</span> <span class="n">IndexBlog1</span> <span class="o">--</span><span class="n">name</span> <span class="n">index_title</span> <span class="o">--</span><span class="n">flags</span> <span class="n">COLUMN_INDEX</span><span class="o">|</span><span class="n">WITH_POSITION</span> <span class="o">--</span><span class="nb">type</span> <span class="n">Blog1</span> <span class="o">--</span><span class="n">source</span> <span class="n">title</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">column_create</span> <span class="o">--</span><span class="n">table</span> <span class="n">IndexBlog1</span> <span class="o">--</span><span class="n">name</span> <span class="n">index_message</span> <span class="o">--</span><span class="n">flags</span> <span class="n">COLUMN_INDEX</span><span class="o">|</span><span class="n">WITH_POSITION</span> <span class="o">--</span><span class="nb">type</span> <span class="n">Blog1</span> <span class="o">--</span><span class="n">source</span> <span class="n">message</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Blog1</span>
<span class="p">[</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span><span class="s2">&quot;grn1&quot;</span><span class="p">,</span><span class="s2">&quot;title&quot;</span><span class="p">:</span><span class="s2">&quot;Groonga test&quot;</span><span class="p">,</span><span class="s2">&quot;message&quot;</span><span class="p">:</span><span class="s2">&quot;Groonga message&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span><span class="s2">&quot;grn2&quot;</span><span class="p">,</span><span class="s2">&quot;title&quot;</span><span class="p">:</span><span class="s2">&quot;baseball result&quot;</span><span class="p">,</span><span class="s2">&quot;message&quot;</span><span class="p">:</span><span class="s2">&quot;rakutan eggs 4 - 4 Groonga moritars&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span><span class="s2">&quot;grn3&quot;</span><span class="p">,</span><span class="s2">&quot;title&quot;</span><span class="p">:</span><span class="s2">&quot;Groonga message&quot;</span><span class="p">,</span><span class="s2">&quot;message&quot;</span><span class="p">:</span><span class="s2">&quot;none&quot;</span><span class="p">}</span>
<span class="p">]</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], 3]</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">match_columns</span></code> option of <code class="docutils literal notranslate"><span class="pre">select</span></code> command accepts multiple columns as search target.
Specify query string to <code class="docutils literal notranslate"><span class="pre">query</span></code> option. Then you can do full-text search title and content of blog entries.</p>
<p>Let’s try to search blog entries.</p>
<p>Execution example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="o">--</span><span class="n">table</span> <span class="n">Blog1</span> <span class="o">--</span><span class="n">match_columns</span> <span class="n">title</span><span class="o">||</span><span class="n">message</span> <span class="o">--</span><span class="n">query</span> <span class="n">groonga</span>
<span class="c1"># [</span>
<span class="c1">#   [</span>
<span class="c1">#     0,</span>
<span class="c1">#     1337566253.89858,</span>
<span class="c1">#     0.000355720520019531</span>
<span class="c1">#   ],</span>
<span class="c1">#   [</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         3</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_id&quot;,</span>
<span class="c1">#           &quot;UInt32&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_key&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;message&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;title&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         1,</span>
<span class="c1">#         &quot;grn1&quot;,</span>
<span class="c1">#         &quot;Groonga message&quot;,</span>
<span class="c1">#         &quot;Groonga test&quot;</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         3,</span>
<span class="c1">#         &quot;grn3&quot;,</span>
<span class="c1">#         &quot;none&quot;,</span>
<span class="c1">#         &quot;Groonga message&quot;</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         2,</span>
<span class="c1">#         &quot;grn2&quot;,</span>
<span class="c1">#         &quot;rakutan eggs 4 - 4 Groonga moritars&quot;,</span>
<span class="c1">#         &quot;baseball result&quot;</span>
<span class="c1">#       ]</span>
<span class="c1">#     ]</span>
<span class="c1">#   ]</span>
<span class="c1"># ]</span>
<span class="n">select</span> <span class="o">--</span><span class="n">table</span> <span class="n">Blog1</span> <span class="o">--</span><span class="n">match_columns</span> <span class="n">title</span><span class="o">||</span><span class="n">message</span> <span class="o">--</span><span class="n">query</span> <span class="n">message</span>
<span class="c1"># [</span>
<span class="c1">#   [</span>
<span class="c1">#     0,</span>
<span class="c1">#     1337566253.89858,</span>
<span class="c1">#     0.000355720520019531</span>
<span class="c1">#   ],</span>
<span class="c1">#   [</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         2</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_id&quot;,</span>
<span class="c1">#           &quot;UInt32&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_key&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;message&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;title&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         3,</span>
<span class="c1">#         &quot;grn3&quot;,</span>
<span class="c1">#         &quot;none&quot;,</span>
<span class="c1">#         &quot;Groonga message&quot;</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         1,</span>
<span class="c1">#         &quot;grn1&quot;,</span>
<span class="c1">#         &quot;Groonga message&quot;,</span>
<span class="c1">#         &quot;Groonga test&quot;</span>
<span class="c1">#       ]</span>
<span class="c1">#     ]</span>
<span class="c1">#   ]</span>
<span class="c1"># ]</span>
<span class="n">select</span> <span class="o">--</span><span class="n">table</span> <span class="n">Blog1</span> <span class="o">--</span><span class="n">match_columns</span> <span class="n">title</span> <span class="o">--</span><span class="n">query</span> <span class="n">message</span>
<span class="c1"># [</span>
<span class="c1">#   [</span>
<span class="c1">#     0,</span>
<span class="c1">#     1337566253.89858,</span>
<span class="c1">#     0.000355720520019531</span>
<span class="c1">#   ],</span>
<span class="c1">#   [</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         1</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_id&quot;,</span>
<span class="c1">#           &quot;UInt32&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_key&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;message&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;title&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         3,</span>
<span class="c1">#         &quot;grn3&quot;,</span>
<span class="c1">#         &quot;none&quot;,</span>
<span class="c1">#         &quot;Groonga message&quot;</span>
<span class="c1">#       ]</span>
<span class="c1">#     ]</span>
<span class="c1">#   ]</span>
<span class="c1"># ]</span>
</pre></div>
</div>
</section>
<section id="creating-one-column-index-against-multiple-columns">
<h3><span class="section-number">4.7.1.2. </span>Creating one column index against multiple columns<a class="headerlink" href="#creating-one-column-index-against-multiple-columns" title="Permalink to this heading">#</a></h3>
<p>Groonga also supports one column index against multiple columns.</p>
<p>The difference for previous example is only one column index exists. Thus, There is one common column index against title and message column.</p>
<p>Even though same column index is used, Groonga supports to search against title column only, message column only and title or message column.</p>
<p>Execution example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_create</span> <span class="o">--</span><span class="n">name</span> <span class="n">Blog2</span> <span class="o">--</span><span class="n">flags</span> <span class="n">TABLE_HASH_KEY</span> <span class="o">--</span><span class="n">key_type</span> <span class="n">ShortText</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">column_create</span> <span class="o">--</span><span class="n">table</span> <span class="n">Blog2</span> <span class="o">--</span><span class="n">name</span> <span class="n">title</span> <span class="o">--</span><span class="n">flags</span> <span class="n">COLUMN_SCALAR</span> <span class="o">--</span><span class="nb">type</span> <span class="n">ShortText</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">column_create</span> <span class="o">--</span><span class="n">table</span> <span class="n">Blog2</span> <span class="o">--</span><span class="n">name</span> <span class="n">message</span> <span class="o">--</span><span class="n">flags</span> <span class="n">COLUMN_SCALAR</span> <span class="o">--</span><span class="nb">type</span> <span class="n">ShortText</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">table_create</span> <span class="o">--</span><span class="n">name</span> <span class="n">IndexBlog2</span> <span class="o">--</span><span class="n">flags</span> <span class="n">TABLE_PAT_KEY</span> <span class="o">--</span><span class="n">key_type</span> <span class="n">ShortText</span> <span class="o">--</span><span class="n">default_tokenizer</span> <span class="n">TokenBigram</span> <span class="o">--</span><span class="n">normalizer</span> <span class="n">NormalizerAuto</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">column_create</span> <span class="o">--</span><span class="n">table</span> <span class="n">IndexBlog2</span> <span class="o">--</span><span class="n">name</span> <span class="n">index_blog</span> <span class="o">--</span><span class="n">flags</span> <span class="n">COLUMN_INDEX</span><span class="o">|</span><span class="n">WITH_POSITION</span><span class="o">|</span><span class="n">WITH_SECTION</span> <span class="o">--</span><span class="nb">type</span> <span class="n">Blog2</span> <span class="o">--</span><span class="n">source</span> <span class="n">title</span><span class="p">,</span><span class="n">message</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Blog2</span>
<span class="p">[</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span><span class="s2">&quot;grn1&quot;</span><span class="p">,</span><span class="s2">&quot;title&quot;</span><span class="p">:</span><span class="s2">&quot;Groonga test&quot;</span><span class="p">,</span><span class="s2">&quot;message&quot;</span><span class="p">:</span><span class="s2">&quot;Groonga message&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span><span class="s2">&quot;grn2&quot;</span><span class="p">,</span><span class="s2">&quot;title&quot;</span><span class="p">:</span><span class="s2">&quot;baseball result&quot;</span><span class="p">,</span><span class="s2">&quot;message&quot;</span><span class="p">:</span><span class="s2">&quot;rakutan eggs 4 - 4 Groonga moritars&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span><span class="s2">&quot;grn3&quot;</span><span class="p">,</span><span class="s2">&quot;title&quot;</span><span class="p">:</span><span class="s2">&quot;Groonga message&quot;</span><span class="p">,</span><span class="s2">&quot;message&quot;</span><span class="p">:</span><span class="s2">&quot;none&quot;</span><span class="p">}</span>
<span class="p">]</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], 3]</span>
</pre></div>
</div>
<p>Let’s search same query in previous section. You can get same search results.</p>
<p>Execution example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="o">--</span><span class="n">table</span> <span class="n">Blog2</span> <span class="o">--</span><span class="n">match_columns</span> <span class="n">title</span><span class="o">||</span><span class="n">message</span> <span class="o">--</span><span class="n">query</span> <span class="n">groonga</span>
<span class="c1"># [</span>
<span class="c1">#   [</span>
<span class="c1">#     0,</span>
<span class="c1">#     1337566253.89858,</span>
<span class="c1">#     0.000355720520019531</span>
<span class="c1">#   ],</span>
<span class="c1">#   [</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         3</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_id&quot;,</span>
<span class="c1">#           &quot;UInt32&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_key&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;message&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;title&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         1,</span>
<span class="c1">#         &quot;grn1&quot;,</span>
<span class="c1">#         &quot;Groonga message&quot;,</span>
<span class="c1">#         &quot;Groonga test&quot;</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         2,</span>
<span class="c1">#         &quot;grn2&quot;,</span>
<span class="c1">#         &quot;rakutan eggs 4 - 4 Groonga moritars&quot;,</span>
<span class="c1">#         &quot;baseball result&quot;</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         3,</span>
<span class="c1">#         &quot;grn3&quot;,</span>
<span class="c1">#         &quot;none&quot;,</span>
<span class="c1">#         &quot;Groonga message&quot;</span>
<span class="c1">#       ]</span>
<span class="c1">#     ]</span>
<span class="c1">#   ]</span>
<span class="c1"># ]</span>
<span class="n">select</span> <span class="o">--</span><span class="n">table</span> <span class="n">Blog2</span> <span class="o">--</span><span class="n">match_columns</span> <span class="n">title</span><span class="o">||</span><span class="n">message</span> <span class="o">--</span><span class="n">query</span> <span class="n">message</span>
<span class="c1"># [</span>
<span class="c1">#   [</span>
<span class="c1">#     0,</span>
<span class="c1">#     1337566253.89858,</span>
<span class="c1">#     0.000355720520019531</span>
<span class="c1">#   ],</span>
<span class="c1">#   [</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         2</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_id&quot;,</span>
<span class="c1">#           &quot;UInt32&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_key&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;message&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;title&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         1,</span>
<span class="c1">#         &quot;grn1&quot;,</span>
<span class="c1">#         &quot;Groonga message&quot;,</span>
<span class="c1">#         &quot;Groonga test&quot;</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         3,</span>
<span class="c1">#         &quot;grn3&quot;,</span>
<span class="c1">#         &quot;none&quot;,</span>
<span class="c1">#         &quot;Groonga message&quot;</span>
<span class="c1">#       ]</span>
<span class="c1">#     ]</span>
<span class="c1">#   ]</span>
<span class="c1"># ]</span>
<span class="n">select</span> <span class="o">--</span><span class="n">table</span> <span class="n">Blog2</span> <span class="o">--</span><span class="n">match_columns</span> <span class="n">title</span> <span class="o">--</span><span class="n">query</span> <span class="n">message</span>
<span class="c1"># [</span>
<span class="c1">#   [</span>
<span class="c1">#     0,</span>
<span class="c1">#     1337566253.89858,</span>
<span class="c1">#     0.000355720520019531</span>
<span class="c1">#   ],</span>
<span class="c1">#   [</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         1</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_id&quot;,</span>
<span class="c1">#           &quot;UInt32&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_key&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;message&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;title&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         3,</span>
<span class="c1">#         &quot;grn3&quot;,</span>
<span class="c1">#         &quot;none&quot;,</span>
<span class="c1">#         &quot;Groonga message&quot;</span>
<span class="c1">#       ]</span>
<span class="c1">#     ]</span>
<span class="c1">#   ]</span>
<span class="c1"># ]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There may be a question that “which is the better solution for indexing.”
It depends on the case.</p>
<ul class="simple">
<li><p>Indexes for each column - The update performance tends to be better than multiple colum index because there is enough buffer for updating. On the other hand, the efficiency of disk usage is not so good.</p></li>
<li><p>Indexes for multiple column - It saves disk usage because it shares common buffer. On the other hand, the update performance is not so good.</p></li>
</ul>
</div>
</section>
</section>
<section id="full-text-search-with-specific-index-name">
<span id="id2"></span><h2><span class="section-number">4.7.2. </span>Full text search with specific index name<a class="headerlink" href="#full-text-search-with-specific-index-name" title="Permalink to this heading">#</a></h2>
<p>Groonga also supports full text search with specific index name.</p>
<p>In this section, you learn how to use specific index column efficiently.</p>
<p>Here is the concrete example about specific index name.</p>
<p>Execution example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_create</span> <span class="n">Entries</span> <span class="n">TABLE_HASH_KEY</span> <span class="n">ShortText</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">column_create</span> <span class="n">Entries</span> <span class="n">title</span> <span class="n">COLUMN_SCALAR</span> <span class="n">ShortText</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">column_create</span> <span class="n">Entries</span> <span class="n">body</span> <span class="n">COLUMN_SCALAR</span> <span class="n">ShortText</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Entries</span>
<span class="p">[</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;http://example.com/entry1&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">:</span><span class="s2">&quot;Hello Groonga.&quot;</span><span class="p">,</span> <span class="s2">&quot;body&quot;</span><span class="p">:</span><span class="s2">&quot;This is my first entry.&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;http://example.com/entry2&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">:</span><span class="s2">&quot;Hello world.&quot;</span><span class="p">,</span> <span class="s2">&quot;body&quot;</span><span class="p">:</span><span class="s2">&quot;I love Groonga!&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;http://example.com/entry3&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">:</span><span class="s2">&quot;Hello Mroonga, bye Groonga.&quot;</span><span class="p">,</span> <span class="s2">&quot;body&quot;</span><span class="p">:</span><span class="s2">&quot;I use Mroonga.&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;http://example.com/entry4&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">:</span><span class="s2">&quot;Say, Hello Groonga!&quot;</span><span class="p">,</span> <span class="s2">&quot;body&quot;</span><span class="p">:</span><span class="s2">&quot;I&#39;m back.&quot;</span><span class="p">}</span>
<span class="p">]</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], 4]</span>
<span class="n">table_create</span> <span class="n">Terms</span> <span class="n">TABLE_PAT_KEY</span> <span class="n">ShortText</span> <span class="o">--</span><span class="n">default_tokenizer</span> <span class="n">TokenBigram</span> <span class="o">--</span><span class="n">normalizer</span> <span class="n">NormalizerAuto</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">column_create</span> <span class="n">Terms</span> <span class="n">entries_title</span> <span class="n">COLUMN_INDEX</span><span class="o">|</span><span class="n">WITH_POSITION</span> <span class="n">Entries</span> <span class="n">title</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">column_create</span> <span class="n">Terms</span> <span class="n">entries_body</span> <span class="n">COLUMN_INDEX</span><span class="o">|</span><span class="n">WITH_POSITION</span> <span class="n">Entries</span> <span class="n">body</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">column_create</span> <span class="n">Terms</span> <span class="n">entries_whole</span> <span class="n">COLUMN_INDEX</span><span class="o">|</span><span class="n">WITH_POSITION</span><span class="o">|</span><span class="n">WITH_SECTION</span> <span class="n">Entries</span> <span class="n">title</span><span class="p">,</span><span class="n">body</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
</pre></div>
</div>
<p>The table which stores entries has columns for title and body.
And the terms table has index columns for title and body to entries table.</p>
<p>There are three index columns in terms table.</p>
<ul class="simple">
<li><p>entries_title: index column for title</p></li>
<li><p>entries_body: index column for body</p></li>
<li><p>entries_whole: index column for title and body</p></li>
</ul>
<p>If you specify index column which is related to specific data column, related data column is searched with that index implicitly.</p>
<p>For example, if you want to search title or body only, specify <code class="docutils literal notranslate"><span class="pre">Terms.entries_title</span></code> or <code class="docutils literal notranslate"><span class="pre">Terms.entries_body</span></code> index column.</p>
<p>Execution example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="o">--</span><span class="n">table</span> <span class="n">Entries</span> <span class="o">--</span><span class="n">output_columns</span> <span class="n">title</span> <span class="o">--</span><span class="n">match_columns</span> <span class="n">Terms</span><span class="o">.</span><span class="n">entries_title</span> <span class="o">--</span><span class="n">query</span> <span class="s2">&quot;Groonga&quot;</span>
<span class="c1"># [</span>
<span class="c1">#   [</span>
<span class="c1">#     0,</span>
<span class="c1">#     1337566253.89858,</span>
<span class="c1">#     0.000355720520019531</span>
<span class="c1">#   ],</span>
<span class="c1">#   [</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         3</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;title&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;Hello Groonga.&quot;</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;Hello Mroonga, bye Groonga.&quot;</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;Say, Hello Groonga!&quot;</span>
<span class="c1">#       ]</span>
<span class="c1">#     ]</span>
<span class="c1">#   ]</span>
<span class="c1"># ]</span>
</pre></div>
</div>
<p>This example uses <code class="docutils literal notranslate"><span class="pre">Terms.entries_title</span></code> as index, then search “Groonga” against title data column.</p>
<p>Execution example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="o">--</span><span class="n">table</span> <span class="n">Entries</span> <span class="o">--</span><span class="n">output_columns</span> <span class="n">body</span> <span class="o">--</span><span class="n">match_columns</span> <span class="n">Terms</span><span class="o">.</span><span class="n">entries_body</span> <span class="o">--</span><span class="n">query</span> <span class="s2">&quot;Groonga&quot;</span>
<span class="c1"># [</span>
<span class="c1">#   [</span>
<span class="c1">#     0,</span>
<span class="c1">#     1337566253.89858,</span>
<span class="c1">#     0.000355720520019531</span>
<span class="c1">#   ],</span>
<span class="c1">#   [</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         1</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;body&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;I love Groonga!&quot;</span>
<span class="c1">#       ]</span>
<span class="c1">#     ]</span>
<span class="c1">#   ]</span>
<span class="c1"># ]</span>
</pre></div>
</div>
<p>This example uses <code class="docutils literal notranslate"><span class="pre">Terms.entries_body</span></code> as index, then search “Groonga” against body data column.</p>
<p>If you specify multiple index column which is related to specific data columns, you can also specify data column name as suffix. It means that “Use specific index and search specific data column explicitly”.</p>
<p>For example, if you want to search title or body only with <code class="docutils literal notranslate"><span class="pre">entries_whole</span></code> index, specify <code class="docutils literal notranslate"><span class="pre">Terms.entries_whole.title</span></code> or <code class="docutils literal notranslate"><span class="pre">Terms.entries_whole.body</span></code>. It uses <code class="docutils literal notranslate"><span class="pre">Terms.entries_whole</span></code> index and search <code class="docutils literal notranslate"><span class="pre">title</span></code> column or <code class="docutils literal notranslate"><span class="pre">body</span></code> column explicitly.</p>
<p>Execution example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="o">--</span><span class="n">table</span> <span class="n">Entries</span> <span class="o">--</span><span class="n">output_columns</span> <span class="n">title</span> <span class="o">--</span><span class="n">match_columns</span> <span class="n">Terms</span><span class="o">.</span><span class="n">entries_whole</span><span class="o">.</span><span class="n">title</span> <span class="o">--</span><span class="n">query</span> <span class="s2">&quot;Groonga&quot;</span>
<span class="c1"># [</span>
<span class="c1">#   [</span>
<span class="c1">#     0,</span>
<span class="c1">#     1337566253.89858,</span>
<span class="c1">#     0.000355720520019531</span>
<span class="c1">#   ],</span>
<span class="c1">#   [</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         3</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;title&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;Hello Groonga.&quot;</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;Hello Mroonga, bye Groonga.&quot;</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;Say, Hello Groonga!&quot;</span>
<span class="c1">#       ]</span>
<span class="c1">#     ]</span>
<span class="c1">#   ]</span>
<span class="c1"># ]</span>
</pre></div>
</div>
<p>This example uses <code class="docutils literal notranslate"><span class="pre">Terms.entries_whole</span></code> as index, then search “Groonga” against title data column.</p>
<p>Execution example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="o">--</span><span class="n">table</span> <span class="n">Entries</span> <span class="o">--</span><span class="n">output_columns</span> <span class="n">body</span> <span class="o">--</span><span class="n">match_columns</span> <span class="n">Terms</span><span class="o">.</span><span class="n">entries_whole</span><span class="o">.</span><span class="n">body</span> <span class="o">--</span><span class="n">query</span> <span class="s2">&quot;Groonga&quot;</span>
<span class="c1"># [</span>
<span class="c1">#   [</span>
<span class="c1">#     0,</span>
<span class="c1">#     1337566253.89858,</span>
<span class="c1">#     0.000355720520019531</span>
<span class="c1">#   ],</span>
<span class="c1">#   [</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         1</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;body&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;I love Groonga!&quot;</span>
<span class="c1">#       ]</span>
<span class="c1">#     ]</span>
<span class="c1">#   ]</span>
<span class="c1"># ]</span>
</pre></div>
</div>
<p>This example uses <code class="docutils literal notranslate"><span class="pre">Terms.entries_whole</span></code> as index, then search “Groonga” against body data column.</p>
</section>
<section id="nested-index-search-among-related-table-by-column-index">
<span id="nested-index-search"></span><h2><span class="section-number">4.7.3. </span>Nested index search among related table by column index<a class="headerlink" href="#nested-index-search-among-related-table-by-column-index" title="Permalink to this heading">#</a></h2>
<p>If there are relationships among multiple table with column index,
you can search multiple table by specifying reference column name.</p>
<p>Here is the concrete example.</p>
<p>There are tables which store blog articles, comments for articles.
The table which stores articles has columns for article and comment.
And the comment column refers Comments table.
The table which stores comments has columns for comment and column index to article table.</p>
<p>if you want to search the articles which contain specified keyword in comment,
you need to execute fulltext search for table of comment, then search the records which contains fulltext search results.</p>
<p>But, you can search the records by specifying the reference column index at once.</p>
<p>Here is the sample schema.</p>
<p>Execution example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_create</span> <span class="n">Comments</span> <span class="n">TABLE_HASH_KEY</span> <span class="n">UInt32</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">column_create</span> <span class="n">Comments</span> <span class="n">content</span> <span class="n">COLUMN_SCALAR</span> <span class="n">ShortText</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">table_create</span> <span class="n">Articles</span> <span class="n">TABLE_NO_KEY</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">column_create</span> <span class="n">Articles</span> <span class="n">content</span> <span class="n">COLUMN_SCALAR</span> <span class="n">Text</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">column_create</span> <span class="n">Articles</span> <span class="n">comment</span> <span class="n">COLUMN_SCALAR</span> <span class="n">Comments</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">table_create</span> <span class="n">Lexicon</span> <span class="n">TABLE_PAT_KEY</span> <span class="n">ShortText</span> <span class="o">--</span><span class="n">default_tokenizer</span> <span class="n">TokenBigram</span> <span class="o">--</span><span class="n">normalizer</span> <span class="n">NormalizerAuto</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">column_create</span> <span class="n">Lexicon</span> <span class="n">articles_content</span> <span class="n">COLUMN_INDEX</span><span class="o">|</span><span class="n">WITH_POSITION</span> <span class="n">Articles</span> <span class="n">content</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">column_create</span> <span class="n">Lexicon</span> <span class="n">comments_content</span> <span class="n">COLUMN_INDEX</span><span class="o">|</span><span class="n">WITH_POSITION</span> <span class="n">Comments</span> <span class="n">content</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">column_create</span> <span class="n">Comments</span> <span class="n">article</span> <span class="n">COLUMN_INDEX</span> <span class="n">Articles</span> <span class="n">comment</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
</pre></div>
</div>
<p>Here is the sample data.</p>
<p>Execution example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Comments</span>
<span class="p">[</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;I&#39;m using Groonga too!&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;I&#39;m using Groonga and Mroonga!&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;I&#39;m using Mroonga too!&quot;</span><span class="p">}</span>
<span class="p">]</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], 3]</span>
<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Articles</span>
<span class="p">[</span>
<span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Groonga is fast!&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Groonga is useful!&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Mroonga is fast!&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
<span class="p">]</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], 3]</span>
</pre></div>
</div>
<p>You can write the query that search the records which contains specified keyword as a comment, then fetch the articles which refers to it.</p>
<p>Query for searching the records described above:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="n">Articles</span> <span class="o">--</span><span class="n">match_columns</span> <span class="n">comment</span><span class="o">.</span><span class="n">content</span> <span class="o">--</span><span class="n">query</span> <span class="n">groonga</span> <span class="o">--</span><span class="n">output_columns</span> <span class="s2">&quot;_id, _score, *&quot;</span>
</pre></div>
</div>
<p>You need to concatenate comment column of Articles table and content column of Comments table with period( <code class="docutils literal notranslate"><span class="pre">.</span></code> ) as <code class="docutils literal notranslate"><span class="pre">--match_columns</span></code> arguments.</p>
<p>At first, this query execute fulltext search from content of Comments table, then fetch the records of Articles table which refers to already searched records of Comments table.
(Because of this, if you comment out the query which creates index column <code class="docutils literal notranslate"><span class="pre">article</span></code> of Comments table, you can’t get intended search results.)</p>
<p>Execution example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="n">Articles</span> <span class="o">--</span><span class="n">match_columns</span> <span class="n">comment</span><span class="o">.</span><span class="n">content</span> <span class="o">--</span><span class="n">query</span> <span class="n">groonga</span> <span class="o">--</span><span class="n">output_columns</span> <span class="s2">&quot;_id, _score, *&quot;</span>
<span class="c1"># [</span>
<span class="c1">#   [</span>
<span class="c1">#     0,</span>
<span class="c1">#     1337566253.89858,</span>
<span class="c1">#     0.000355720520019531</span>
<span class="c1">#   ],</span>
<span class="c1">#   [</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         1</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_id&quot;,</span>
<span class="c1">#           &quot;UInt32&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_score&quot;,</span>
<span class="c1">#           &quot;Int32&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;comment&quot;,</span>
<span class="c1">#           &quot;Comments&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;content&quot;,</span>
<span class="c1">#           &quot;Text&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         1,</span>
<span class="c1">#         1,</span>
<span class="c1">#         1,</span>
<span class="c1">#         &quot;Groonga is fast!&quot;</span>
<span class="c1">#       ]</span>
<span class="c1">#     ]</span>
<span class="c1">#   ]</span>
<span class="c1"># ]</span>
</pre></div>
</div>
<p>Now, you can search articles which contains specific keywords as a comment.</p>
<p>The feature of nested index search is not limited to the relationship between two table only.</p>
<p>Here is the sample schema similar to previous one. The difference is added table which express ‘Reply’ and relationship is extended to three tables.</p>
<p>Execution example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_create</span> <span class="n">Replies2</span> <span class="n">TABLE_HASH_KEY</span> <span class="n">UInt32</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">column_create</span> <span class="n">Replies2</span> <span class="n">content</span> <span class="n">COLUMN_SCALAR</span> <span class="n">ShortText</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">table_create</span> <span class="n">Comments2</span> <span class="n">TABLE_HASH_KEY</span> <span class="n">UInt32</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">column_create</span> <span class="n">Comments2</span> <span class="n">content</span> <span class="n">COLUMN_SCALAR</span> <span class="n">ShortText</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">column_create</span> <span class="n">Comments2</span> <span class="n">comment</span> <span class="n">COLUMN_SCALAR</span> <span class="n">Replies2</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">table_create</span> <span class="n">Articles2</span> <span class="n">TABLE_NO_KEY</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">column_create</span> <span class="n">Articles2</span> <span class="n">content</span> <span class="n">COLUMN_SCALAR</span> <span class="n">Text</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">column_create</span> <span class="n">Articles2</span> <span class="n">comment</span> <span class="n">COLUMN_SCALAR</span> <span class="n">Comments2</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">table_create</span> <span class="n">Lexicon2</span> <span class="n">TABLE_PAT_KEY</span> <span class="n">ShortText</span> <span class="o">--</span><span class="n">default_tokenizer</span> <span class="n">TokenBigram</span> <span class="o">--</span><span class="n">normalizer</span> <span class="n">NormalizerAuto</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">column_create</span> <span class="n">Lexicon2</span> <span class="n">articles_content</span> <span class="n">COLUMN_INDEX</span><span class="o">|</span><span class="n">WITH_POSITION</span> <span class="n">Articles2</span> <span class="n">content</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">column_create</span> <span class="n">Lexicon2</span> <span class="n">comments_content</span> <span class="n">COLUMN_INDEX</span><span class="o">|</span><span class="n">WITH_POSITION</span> <span class="n">Comments2</span> <span class="n">content</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">column_create</span> <span class="n">Lexicon2</span> <span class="n">replies_content</span> <span class="n">COLUMN_INDEX</span><span class="o">|</span><span class="n">WITH_POSITION</span> <span class="n">Replies2</span> <span class="n">content</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">column_create</span> <span class="n">Comments2</span> <span class="n">article</span> <span class="n">COLUMN_INDEX</span> <span class="n">Articles2</span> <span class="n">comment</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">column_create</span> <span class="n">Replies2</span> <span class="n">reply_to</span> <span class="n">COLUMN_INDEX</span> <span class="n">Comments2</span> <span class="n">comment</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
</pre></div>
</div>
<p>Here is the sample data.</p>
<p>Execution example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Replies2</span>
<span class="p">[</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;I&#39;m using Rroonga too!&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;I&#39;m using Groonga and Mroonga and Rroonga!&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;I&#39;m using Nroonga too!&quot;</span><span class="p">}</span>
<span class="p">]</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], 3]</span>
<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Comments2</span>
<span class="p">[</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;I&#39;m using Groonga too!&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;I&#39;m using Groonga and Mroonga!&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;I&#39;m using Mroonga too!&quot;</span><span class="p">}</span>
<span class="p">]</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], 3]</span>
<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Articles2</span>
<span class="p">[</span>
<span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Groonga is fast!&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Groonga is useful!&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Mroonga is fast!&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
<span class="p">]</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], 3]</span>
</pre></div>
</div>
<p>Query for searching the records described above:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="n">Articles2</span> <span class="o">--</span><span class="n">match_columns</span> <span class="n">comment</span><span class="o">.</span><span class="n">content</span> <span class="o">--</span><span class="n">query</span> <span class="n">mroonga</span> <span class="o">--</span><span class="n">output_columns</span> <span class="s2">&quot;_id, _score, *&quot;</span>
<span class="n">select</span> <span class="n">Articles2</span> <span class="o">--</span><span class="n">match_columns</span> <span class="n">comment</span><span class="o">.</span><span class="n">comment</span><span class="o">.</span><span class="n">content</span> <span class="o">--</span><span class="n">query</span> <span class="n">mroonga</span> <span class="o">--</span><span class="n">output_columns</span> <span class="s2">&quot;_id, _score, *&quot;</span>
</pre></div>
</div>
<p>The first query searches <code class="docutils literal notranslate"><span class="pre">mroonga</span></code> from <code class="docutils literal notranslate"><span class="pre">Comments2</span></code> table, the second one searches <code class="docutils literal notranslate"><span class="pre">mroonga</span></code> from <code class="docutils literal notranslate"><span class="pre">Replies2</span></code> and <code class="docutils literal notranslate"><span class="pre">Comments2</span></code> table by using reference column index.</p>
<p>Execution example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="n">Articles2</span> <span class="o">--</span><span class="n">match_columns</span> <span class="n">comment</span><span class="o">.</span><span class="n">content</span> <span class="o">--</span><span class="n">query</span> <span class="n">mroonga</span> <span class="o">--</span><span class="n">output_columns</span> <span class="s2">&quot;_id, _score, *&quot;</span>
<span class="c1"># [</span>
<span class="c1">#   [</span>
<span class="c1">#     0,</span>
<span class="c1">#     1337566253.89858,</span>
<span class="c1">#     0.000355720520019531</span>
<span class="c1">#   ],</span>
<span class="c1">#   [</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         2</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_id&quot;,</span>
<span class="c1">#           &quot;UInt32&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_score&quot;,</span>
<span class="c1">#           &quot;Int32&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;comment&quot;,</span>
<span class="c1">#           &quot;Comments2&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;content&quot;,</span>
<span class="c1">#           &quot;Text&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         2,</span>
<span class="c1">#         1,</span>
<span class="c1">#         2,</span>
<span class="c1">#         &quot;Groonga is useful!&quot;</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         3,</span>
<span class="c1">#         1,</span>
<span class="c1">#         3,</span>
<span class="c1">#         &quot;Mroonga is fast!&quot;</span>
<span class="c1">#       ]</span>
<span class="c1">#     ]</span>
<span class="c1">#   ]</span>
<span class="c1"># ]</span>
<span class="n">select</span> <span class="n">Articles2</span> <span class="o">--</span><span class="n">match_columns</span> <span class="n">comment</span><span class="o">.</span><span class="n">comment</span><span class="o">.</span><span class="n">content</span> <span class="o">--</span><span class="n">query</span> <span class="n">mroonga</span> <span class="o">--</span><span class="n">output_columns</span> <span class="s2">&quot;_id, _score, *&quot;</span>
<span class="c1"># [</span>
<span class="c1">#   [</span>
<span class="c1">#     0,</span>
<span class="c1">#     1337566253.89858,</span>
<span class="c1">#     0.000355720520019531</span>
<span class="c1">#   ],</span>
<span class="c1">#   [</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         1</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_id&quot;,</span>
<span class="c1">#           &quot;UInt32&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_score&quot;,</span>
<span class="c1">#           &quot;Int32&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;comment&quot;,</span>
<span class="c1">#           &quot;Comments2&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;content&quot;,</span>
<span class="c1">#           &quot;Text&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         2,</span>
<span class="c1">#         1,</span>
<span class="c1">#         2,</span>
<span class="c1">#         &quot;Groonga is useful!&quot;</span>
<span class="c1">#       ]</span>
<span class="c1">#     ]</span>
<span class="c1">#   ]</span>
<span class="c1"># ]</span>
</pre></div>
</div>
<p>As a result, the first query matches two article because of <code class="docutils literal notranslate"><span class="pre">Comments2</span></code> table has two records which contains <code class="docutils literal notranslate"><span class="pre">mroonga</span></code> as keyword.</p>
<p>On the other hand, the second one matches one article only because of <code class="docutils literal notranslate"><span class="pre">Replies2</span></code> table has only one record which contains <code class="docutils literal notranslate"><span class="pre">mroonga</span></code> as keyword, and there is one record which contains same keyword and refers to the record in <code class="docutils literal notranslate"><span class="pre">Comments2</span></code> table.</p>
</section>
<section id="indexes-with-weight">
<h2><span class="section-number">4.7.4. </span>Indexes with Weight<a class="headerlink" href="#indexes-with-weight" title="Permalink to this heading">#</a></h2>
<p>If index columns are created for data columns, you can search by indexes with weight.
For example, let’s try to search blog entries by indexes with weight which contains <code class="docutils literal notranslate"><span class="pre">Groonga</span></code> as important keyword in <code class="docutils literal notranslate"><span class="pre">Blog1</span></code> table.
Generally speaking, an important keyword tend to be included in blog title, so if <code class="docutils literal notranslate"><span class="pre">title</span></code> column contains <code class="docutils literal notranslate"><span class="pre">Groonga</span></code>, its score ( <code class="docutils literal notranslate"><span class="pre">_score</span></code> ) must be raised in contrast to <code class="docutils literal notranslate"><span class="pre">message</span></code> column. The indexes with weight is used for such a purpose.</p>
<p>Here is the example which search blog entries with <code class="docutils literal notranslate"><span class="pre">Groonga</span></code> as important keyword in <code class="docutils literal notranslate"><span class="pre">title</span></code> or <code class="docutils literal notranslate"><span class="pre">message</span></code> columns.</p>
<p>The sample schema and data is same as <a class="reference internal" href="#creating-column-index-against-each-column"><span class="std std-ref">Creating column index against each column</span></a>.</p>
<p>Execution example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="o">--</span><span class="n">table</span> <span class="n">Blog1</span> <span class="o">--</span><span class="n">match_columns</span> <span class="s1">&#39;IndexBlog1.index_title * 10 || IndexBlog1.index_message&#39;</span> <span class="o">--</span><span class="n">query</span> <span class="s1">&#39;Groonga&#39;</span> <span class="o">--</span><span class="n">output_columns</span> <span class="s2">&quot;_id, _score, *&quot;</span>
<span class="c1"># [</span>
<span class="c1">#   [</span>
<span class="c1">#     0,</span>
<span class="c1">#     1337566253.89858,</span>
<span class="c1">#     0.000355720520019531</span>
<span class="c1">#   ],</span>
<span class="c1">#   [</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         3</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_id&quot;,</span>
<span class="c1">#           &quot;UInt32&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_score&quot;,</span>
<span class="c1">#           &quot;Int32&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;message&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;title&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         1,</span>
<span class="c1">#         11,</span>
<span class="c1">#         &quot;Groonga message&quot;,</span>
<span class="c1">#         &quot;Groonga test&quot;</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         3,</span>
<span class="c1">#         10,</span>
<span class="c1">#         &quot;none&quot;,</span>
<span class="c1">#         &quot;Groonga message&quot;</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         2,</span>
<span class="c1">#         1,</span>
<span class="c1">#         &quot;rakutan eggs 4 - 4 Groonga moritars&quot;,</span>
<span class="c1">#         &quot;baseball result&quot;</span>
<span class="c1">#       ]</span>
<span class="c1">#     ]</span>
<span class="c1">#   ]</span>
<span class="c1"># ]</span>
</pre></div>
</div>
<p>In above query, <code class="docutils literal notranslate"><span class="pre">'IndexBlog1.index_title</span> <span class="pre">*</span> <span class="pre">10</span> <span class="pre">||</span> <span class="pre">IndexBlog1.index_message'</span></code> is specified for <code class="docutils literal notranslate"><span class="pre">--match_columns</span></code>.
It means that if <code class="docutils literal notranslate"><span class="pre">title</span></code> column (search <code class="docutils literal notranslate"><span class="pre">title</span></code> column using <code class="docutils literal notranslate"><span class="pre">IndexBlog1.index_title</span></code> index) matches to <code class="docutils literal notranslate"><span class="pre">Groonga</span></code>, its weight is multiplied to 10 and if <code class="docutils literal notranslate"><span class="pre">message</span></code> column (search <code class="docutils literal notranslate"><span class="pre">message</span></code> column using <code class="docutils literal notranslate"><span class="pre">IndexBlog1.index_message</span></code> index) matches to <code class="docutils literal notranslate"><span class="pre">Groonga</span></code>,
its weight is 1 (default). If <code class="docutils literal notranslate"><span class="pre">Groonga</span></code> matches to <code class="docutils literal notranslate"><span class="pre">title</span></code> and <code class="docutils literal notranslate"><span class="pre">message</span></code>, its weight is 11 (10 + 1) in this case.</p>
<p>As a result, <code class="docutils literal notranslate"><span class="pre">Groonga</span> <span class="pre">test</span></code> blog entry is listed in first.</p>
</section>
</section>


            </article>
            
            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="index.html" title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title"><span class="section-number">4.6. </span>Tag search and reverse resolution of reference relationships</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="patricia_trie.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title"><span class="section-number">4.8. </span>Prefix search with patricia trie</p>
  </div>
  <i class="fa-solid fa-angle-right"></i>
  </a>
</div>
            </footer>
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
</div>
<nav id="bd-toc-nav" class="page-toc">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#full-text-search-against-multiple-columns">
   4.7.1. Full-text search against multiple columns
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creating-column-index-against-each-column">
     4.7.1.1. Creating column index against each column
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creating-one-column-index-against-multiple-columns">
     4.7.1.2. Creating one column index against multiple columns
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#full-text-search-with-specific-index-name">
   4.7.2. Full text search with specific index name
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#nested-index-search-among-related-table-by-column-index">
   4.7.3. Nested index search among related table by column index
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#indexes-with-weight">
   4.7.4. Indexes with Weight
  </a>
 </li>
</ul>

</nav>
</div>

<div class="toc-item">
  
<div id="searchbox"></div>
</div>

<div class="toc-item">
  

<div class="tocsection editthispage">
    <a href="https://github.com/groonga/groonga/edit/master/doc/source/tutorial/match_columns.rst">
        <i class="fa-solid fa-pencil"></i> Edit this page
    </a>
</div>

</div>

<div class="toc-item">
  
</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
          </div>
        </footer>
        
      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94"></script>

  <footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    
<p class="copyright">

    &copy; Copyright 2009-2023 Groonga Project.<br>

</p>

  </div>
  
  <div class="footer-item">
    <p class="theme-version">
    Built with the
    <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">
        PyData Sphinx Theme
    </a>
    0.12.0.
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
  </footer>
  </body>
</html>